@inject RoleManager<IdentityRole> RoleManager

@{
    Layout = null;
}


<h5 style="text-align:center">Crear un nuevo Rol</h5>
<div class="container">
    <div class="row">
        <div class="col-md-2 text-right">
            <label class="control-label">Nuevo Rol:</label>
        </div>
        <div class="col-md-5">
            <input type="text" class="form-control" id="roleName" />
        </div>
        <div class="col-md-2">
            <button class="btn-primary form-control" id="newRole" onclick="SaveNewRole()">Guardar</button>
        </div>
    </div>
</div>
<hr class="col-md-offset-2" />
<h5 style="text-align:center">Modificar un Rol</h5>
<div class="container">
    <div class="row">
        <div class="col-md-5 col-md-offset-1">
            @{
                var listRoles = RoleManager.Roles.OrderBy(x => x.Name).ToList();
            }
            @Html.DropDownList("listaRolesAdd", new SelectList(listRoles, "Id", "Name"),"Seleccione un Rol..", new { @class = "form-control dropdown desplegables" })
        </div>
        <div class="col-md-2">
            <button class="btn-primary form-control" id="updateRole">Guardar</button>
        </div>
    </div>
</div>
<hr class="col-md-offset-2" />
<h5 style="text-align:center">Borrar un Rol</h5>
<div class="container">
    <div class="row">
        @*Asignacion de roles*@
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-md-5 col-md-offset-1">
            @Html.DropDownList("listaRolesDel", new SelectList(listRoles, "Id", "Name"), "Seleccione un Rol..", new { @class = "form-control dropdown desplegables" })
        </div>
        <div class="col-md-2">
            <button class="btn-primary form-control" id="delRole" onclick="RemoveRole()">Borrar</button>
        </div>
    </div>
</div>
<script type="text/javascript">
    function SaveNewRole() {
        if (!$("#roleName").val())
            return;
            $.ajax({
              url: "@Url.Action("AddNewRole", "Manage")",
                data: { roleName: $("#roleName").val() },
              type: "post",
                success: function (data) {
                    $("#listaRolesAdd").append(new Option($("#roleName").val(), data, false, true));
                    $("#listaRolesDel").append(new Option($("#roleName").val(), data, false, true));
                },
              error: function() {
                alert("Oops, hemos tenido un problema...");
              }
            });
        }
    function RemoveRole() {
        if (!$("#listaRolesDel").val())
            return;
            $.ajax({
              url: "@Url.Action("RemoveRole", "Manage")",
                data: { id: $("#listaRolesDel").val() },
              type: "post",
                success: function (data) {
                    $(".desplegables option[value=" + $("#listaRolesDel").val()+"]").remove()
                },
              error: function() {
                alert("Oops, hemos tenido un problema...");
              }
            });
        }
</script>
